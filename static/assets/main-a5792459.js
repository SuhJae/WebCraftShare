import{d as ee,r as o,c as te,a as l,b as e,t as i,e as j,u as T,f as r,w as R,g as u,v as c,h as O,F as se,_ as ae,i as oe,o as n,j as V,k as le}from"./XMarkIcon-00ce67d5.js";const ne={key:0,class:"model fixed inset-0 flex items-start justify-center pt-20"},ie={class:"model__content p-6 glass-morphic-window w-96 absolute top-1/5 left-1/2 transform -translate-x-1/2"},re={class:"model__header flex justify-between items-center mb-4"},de={class:"model__title text-2xl font-semibold"},ue={class:"model__body"},ce=["innerHTML"],me={key:1,class:"dialog fixed inset-0 flex items-start justify-center pt-20"},ve={class:"model__content p-6 glass-morphic-window w-96 absolute top-1/5 left-1/2 transform -translate-x-1/2"},pe={class:"dialog__header flex justify-between items-center mb-4"},he=e("h2",{class:"dialog__title text-2xl font-semibold"}," Password recovery ",-1),fe={class:"dialog__body"},_e=["onSubmit"],ge=e("label",{for:"email",class:"block text-sm font-medium leading-6"},"Email address",-1),be={class:"mt-2"},we={key:0,class:"text-red-600 dark:text-red-400"},ye=["disabled"],ke={key:2,class:"dialog fixed inset-0 flex items-start justify-center pt-20"},xe={class:"model__content p-6 glass-morphic-window w-96 absolute top-1/5 left-1/2 transform -translate-x-1/2"},Ce={class:"dialog__header flex justify-between items-center mb-4"},Ee={class:"dialog__title text-2xl font-semibold"},Se={class:"dialog__body"},$e=["onSubmit"],Ue=e("p",{class:"pb-1"},"We will send you code that is required to verify your email.",-1),Pe=e("label",{for:"email",class:"block text-sm font-medium leading-6"},"Email address",-1),je={class:"mt-2"},Te={key:0,class:"text-red-600 dark:text-red-400"},Re=["disabled"],Ve={key:3,class:"dialog fixed inset-0 flex items-start justify-center pt-20"},Ie={class:"model__content p-6 glass-morphic-window w-96 absolute top-1/5 left-1/2 transform -translate-x-1/2"},qe={class:"dialog__header flex justify-between items-center mb-4"},Ne=e("h2",{class:"dialog__title text-2xl font-semibold"}," Sign Up ",-1),ze={class:"dialog__body"},Me=["onSubmit"],Ke=e("label",{for:"email",class:"block text-sm font-medium leading-6"},"Email address",-1),Oe={class:"mt-2"},Le=["value"],Fe=e("label",{for:"username",class:"block text-sm font-medium leading-6"},"Access code",-1),Be={class:"mt-2"},De=e("label",{for:"username",class:"block text-sm font-medium leading-6"},"Nickname",-1),Ae={class:"mt-2"},He={key:0,class:"text-red-600 dark:text-red-400"},Ye={key:1},We=e("small",{class:"text-green-600 dark:text-green-400"}," Your websites will be hosted at: ",-1),Ge={class:"hover"},Je=e("label",{for:"password",class:"block text-sm font-medium leading-6"},"Password",-1),Qe={class:"mt-2"},Xe={key:0,class:"text-red-600 dark:text-red-400"},Ze={class:"mt-2"},et={key:0,class:"text-red-600 dark:text-red-400"},tt=["disabled"],st={class:"relative top-40"},at={class:"flex min-h-full flex-1 flex-col justify-center px-6 py-12 lg:px-8"},ot={class:"sm:mx-auto sm:w-full sm:max-w-sm"},lt={key:0,class:"mx-auto h-10 w-auto",src:ae,alt:"Organization logo dark version"},nt={key:1,class:"mx-auto h-10 w-auto",src:oe,alt:"Organization logo"},it=e("h2",{class:"mt-10 text-center text-2xl font-bold leading-9 tracking-tight"},"Sign in to your account",-1),rt={class:"mt-10 sm:mx-auto sm:w-full sm:max-w-sm"},dt=["onSubmit"],ut=e("label",{for:"email",class:"block text-sm font-medium leading-6"},"Email address",-1),ct={class:"mt-2"},mt={key:0,class:"text-red-600 dark:text-red-400"},vt={class:"flex items-center justify-between"},pt=e("label",{for:"password",class:"block text-sm font-medium leading-6"},"Password",-1),ht={class:"text-sm"},ft={class:"mt-2"},_t=["disabled"],gt={key:0,class:"text-red-600 dark:text-red-400"},bt={class:"mt-10 text-center text-sm"},wt=ee({__name:"index",setup(yt){const L=o(""),I=o(!1),h=o(!1),F=o(""),q=o(""),C=o(""),E=o(""),S=o(""),$=o(""),N=o(""),f=o(!1),_=o(""),U=o(""),g=o(!1),v=o(""),b=o(""),w=o(!1),z=o(""),y=o(""),k=o(""),p=o(""),x=o(""),P=o(""),B=o(!1),M=o(""),m={};function d(a,t){F.value=a,q.value=t,h.value=!0}window.addEventListener("keydown",a=>{a.key==="Escape"&&(h.value=!1)});function K(a){const t=/\S+@\S+\.\S+/,s=new RegExp(`@${N.value}$`);return a===""?"":t.test(a)?s.test(a)?"valid":`Please enter a ${$.value} (${N.value}) email!`:"Please enter a valid email!"}async function A(a){if(a==="")return"";if(a.length<3)return"Nickname must be at least 3 characters!";if(a.length>20)return"Nickname must be less than 20 characters!";if(!/^[a-z0-9]+$/i.test(a))return"Nickname must be alphanumeric!";if(m[a]){if(m[a]==="r")return"Nickname is reserved!";if(m[a]==="e")return"Nickname already exists!";if(m[a]==="v")return"valid"}y.value="checking . . .";const s=await(await fetch(`/auth/checkhandle?handle=${encodeURIComponent(a)}`)).json();return s.reserved?(m[a]="r","Nickname is reserved!"):s.exists?(m[a]="e","Nickname already exists!"):(m[a]="v","valid")}async function D(){y.value=await A(k.value)}function H(a){return a===""?"":a.length<8?"Password must be at least 8 characters!":/^[a-z0-9!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/? ]+$/i.test(a)?/\d/.test(a)?"valid":"Password must contain at least one number!":"Password must be alphanumeric with special characters!"}async function Y(){B.value=!0;try{const t=await(await fetch("/auth/authenticate",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`email=${encodeURIComponent(E.value)}&password=${encodeURIComponent(S.value)}`})).json();t.success?window.location.href="/home/":M.value=t.message}catch{d("Communication Error","Error occurred while communicating to the server while logging in. Please try again.")}finally{B.value=!1}}async function W(){try{const t=await(await fetch("/auth/forgot",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`email=${encodeURIComponent(_.value)}`})).json();f.value=!1,_.value="",d("Check your email!",t.message)}catch{d("Communication Error","Error occurred while communicating to the server while resetting password. Please try again.")}}async function G(){const t=await(await fetch(`/auth/authmail?email=${encodeURIComponent(v.value)}`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded&"}})).json();if(t.success)d("Check your email!",t.message),g.value=!1,w.value=!0;else{d("Error",t.message);return}}async function J(){try{const t=await(await fetch("/auth/signup",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`email=${encodeURIComponent(v.value)}&code=${encodeURIComponent(z.value)}&handle=${encodeURIComponent(k.value)}&password=${encodeURIComponent(p.value)}`})).json();if(t.success){w.value=!1,d("Success",'Successfully signed up! You will be redirected to <a href="/home/">home</a> in 3 seconds.');let s=5;const Z=window.setInterval(()=>{s-=.1,s=parseFloat(s.toFixed(1)),s<=0?(clearInterval(Z),window.location.href="/home/"):q.value=`Successfully signed up!<br>Sigining in to <a href="/home/">home</a> in ${s}s...`},100)}else d("Error",t.message)}catch{d("Communication Error","Error occurred while communicating to the server while signing up. Please try again.")}}async function Q(){try{const t=await(await fetch("/auth/org")).json();$.value=t.name,N.value=t.email}catch{d("Communication Error","Error occurred while communicating to the server while fetching organization info. Please try again.")}}window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",a=>{I.value=a.matches}),window.addEventListener("load",()=>{I.value=window.matchMedia("(prefers-color-scheme: dark)").matches,L.value=window.location.origin,Q()});const X=te(()=>b.value==="valid"&&y.value==="valid"&&x.value==="valid"&&p.value===P.value);return(a,t)=>(n(),l(se,null,[h.value?(n(),l("div",ne,[e("div",{class:"absolute inset-0 bg-white bg-opacity-50 dark:bg-black dark:bg-opacity-50 backdrop-blur-sm",onClick:t[0]||(t[0]=s=>h.value=!1)}),e("div",ie,[e("div",re,[e("h2",de,i(F.value),1),e("button",{class:"model__close p-1 hover:bg-slate-200 dark:hover:bg-slate-600 rounded",onClick:t[1]||(t[1]=s=>h.value=!1)},[j(T(V),{class:"h-6 w-6"})])]),e("div",ue,[e("div",{innerHTML:q.value},null,8,ce)])])])):r("",!0),f.value?(n(),l("div",me,[e("div",{class:"absolute inset-0 bg-white bg-opacity-50 dark:bg-black dark:bg-opacity-50 backdrop-blur-sm",onClick:t[2]||(t[2]=s=>f.value=!1)}),e("div",ve,[e("div",pe,[he,e("button",{class:"dialog__close p-1 hover:bg-slate-200 dark:hover:bg-slate-600 rounded",onClick:t[3]||(t[3]=s=>f.value=!1)},[j(T(V),{class:"h-6 w-6"})])]),e("div",fe,[e("form",{class:"space-y-6",onSubmit:R(W,["prevent"])},[e("div",null,[ge,e("div",be,[u(e("input",{autocomplete:"email",placeholder:"Enter your email","onUpdate:modelValue":t[4]||(t[4]=s=>_.value=s),required:!0,onKeyup:t[5]||(t[5]=s=>U.value=K(_.value)),class:"glass-morphic-input"},null,544),[[c,_.value]]),U.value!=="valid"?(n(),l("small",we,i(U.value),1)):r("",!0)])]),e("div",null,[e("button",{type:"submit",disabled:U.value!=="valid",class:"big-green-button"},"Send email ",8,ye)])],40,_e)])])])):r("",!0),g.value?(n(),l("div",ke,[e("div",{class:"absolute inset-0 bg-white bg-opacity-50 dark:bg-black dark:bg-opacity-50 backdrop-blur-sm",onClick:t[6]||(t[6]=s=>g.value=!1)}),e("div",xe,[e("div",Ce,[e("h2",Ee," Enter your "+i($.value)+" email! ",1),e("button",{class:"dialog__close p-1 hover:bg-slate-200 dark:hover:bg-slate-600 rounded",onClick:t[7]||(t[7]=s=>g.value=!1)},[j(T(V),{class:"h-6 w-6"})])]),e("div",Se,[e("form",{class:"space-y-6",onSubmit:R(G,["prevent"])},[Ue,e("div",null,[Pe,e("div",je,[u(e("input",{autocomplete:"email",placeholder:"Enter your email","onUpdate:modelValue":t[8]||(t[8]=s=>v.value=s),required:!0,onKeyup:t[9]||(t[9]=s=>b.value=K(v.value)),class:"glass-morphic-input"},null,544),[[c,v.value]]),b.value!=="valid"?(n(),l("small",Te,i(b.value),1)):r("",!0)])]),e("div",null,[e("button",{type:"submit",disabled:b.value!=="valid",class:"big-green-button"}," Send email ",8,Re)])],40,$e)])])])):r("",!0),w.value?(n(),l("div",Ve,[e("div",{class:"absolute inset-0 bg-white bg-opacity-50 dark:bg-black dark:bg-opacity-50 backdrop-blur-sm",onClick:t[10]||(t[10]=s=>w.value=!1)}),e("div",Ie,[e("div",qe,[Ne,e("button",{class:"dialog__close p-1 hover:bg-slate-200 dark:hover:bg-slate-600 rounded",onClick:t[11]||(t[11]=s=>w.value=!1)},[j(T(V),{class:"h-6 w-6"})])]),e("div",ze,[e("form",{class:"space-y-6",onSubmit:R(J,["prevent"])},[e("div",null,[Ke,e("div",Oe,[e("input",{disabled:"",value:v.value,required:!0,class:"glass-morphic-input"},null,8,Le)])]),e("div",null,[Fe,e("div",Be,[u(e("input",{placeholder:"Check your inbox for code","onUpdate:modelValue":t[12]||(t[12]=s=>z.value=s),required:!0,type:"text",onKeyup:D,class:"glass-morphic-input"},null,544),[[c,z.value]])])]),e("div",null,[De,e("div",Ae,[u(e("input",{autocomplete:"username",placeholder:"Choose your nickname","onUpdate:modelValue":t[13]||(t[13]=s=>k.value=s),required:!0,type:"text",onKeyup:D,class:"glass-morphic-input"},null,544),[[c,k.value]]),y.value!=="valid"?(n(),l("small",He,i(y.value),1)):(n(),l("div",Ye,[We,O(),e("small",null,[e("a",Ge,i(L.value)+"/"+i(k.value)+"/",1)])]))])]),e("div",null,[Je,e("div",Qe,[u(e("input",{autocomplete:"new-password",placeholder:"Choose your password","onUpdate:modelValue":t[14]||(t[14]=s=>p.value=s),required:!0,type:"password",onKeyup:t[15]||(t[15]=s=>x.value=H(p.value)),class:"glass-morphic-input"},null,544),[[c,p.value]]),x.value!=="valid"?(n(),l("small",Xe,i(x.value),1)):r("",!0)]),e("div",Ze,[u(e("input",{autocomplete:"new-password",placeholder:"Confirm your password","onUpdate:modelValue":t[16]||(t[16]=s=>P.value=s),required:!0,type:"password",class:"glass-morphic-input"},null,512),[[c,P.value]]),p.value!==P.value&&x.value=="valid"?(n(),l("small",et," Password does not match! ")):r("",!0)])]),e("div",null,[e("button",{type:"submit",disabled:!X.value,class:"big-green-button"},"Submit",8,tt)])],40,Me)])])])):r("",!0),e("div",st,[e("div",at,[e("div",ot,[I.value?(n(),l("img",lt)):(n(),l("img",nt)),it]),e("div",rt,[e("form",{class:"space-y-6",onSubmit:R(Y,["prevent"])},[e("div",null,[ut,e("div",ct,[u(e("input",{autocomplete:"email",placeholder:"Enter your email","onUpdate:modelValue":t[17]||(t[17]=s=>E.value=s),required:!0,type:"email",onKeyup:t[18]||(t[18]=s=>C.value=K(E.value)),class:"global-input"},null,544),[[c,E.value]]),C.value!=="valid"?(n(),l("small",mt,i(C.value),1)):r("",!0)])]),e("div",null,[e("div",vt,[pt,e("div",ht,[e("a",{href:"#",onClick:t[19]||(t[19]=s=>f.value=!0)},"Forgot password?")])]),e("div",ft,[u(e("input",{id:"password",name:"password",type:"password",autocomplete:"current-password","onUpdate:modelValue":t[20]||(t[20]=s=>S.value=s),required:!0,placeholder:"Enter your password",class:"global-input"},null,512),[[c,S.value]])])]),e("div",null,[e("button",{type:"submit",disabled:C.value!=="valid"||S.value==="",class:"big-green-button"}," Sign in ",8,_t),M.value?(n(),l("small",gt,i(M.value),1)):r("",!0)])],40,dt),e("p",bt,[O(" Not a member? "),e("a",{href:"#",onClick:t[21]||(t[21]=s=>g.value=!0)},"Sign up"),O(" with your "+i($.value)+" email! ",1)])])])])],64))}});le(wt).mount("#app");
